{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Welcome to MkDocs","text":"<p>For full documentation visit mkdocs.org.</p>"},{"location":"#commands","title":"Commands","text":"<ul> <li><code>mkdocs new [dir-name]</code> - Create a new project.</li> <li><code>mkdocs serve</code> - Start the live-reloading docs server.</li> <li><code>mkdocs build</code> - Build the documentation site.</li> <li><code>mkdocs -h</code> - Print help message and exit.</li> <li><code>mkdocs gh-deploy --force</code> - \u90e8\u7f72\u81f3 GITHUB PAGE</li> </ul>"},{"location":"#project-layout","title":"Project layout","text":"<pre><code>mkdocs.yml    # The configuration file.\ndocs/\n    index.md  # The documentation homepage.\n    ...       # Other markdown pages, images and other files.\n</code></pre>"},{"location":"Oracle_SQL/","title":"Oracle - SQL","text":""},{"location":"Oracle_SQL/#oracle-sql","title":"Oracle SQL","text":""},{"location":"Oracle_SQL/#_1","title":"Oracle - SQL","text":""},{"location":"Oracle_SQL/#listagg","title":"listagg","text":"<pre><code>SELECT DISTINCT loc.ASSEMBLY_ITEM_NUMBER,\n  loc.COMPONENT_ITEM_NUMBER,\n  loc.QUANTITY,\n  (SELECT listagg(loc2.DESIGNATOR, ',') within GROUP (\n  ORDER BY loc2.DESIGNATOR DESC)\n  FROM V_PARTUSAGELINK_LOC loc2\n  WHERE loc2.COMPONENT_ITEM_NUMBER = loc.COMPONENT_ITEM_NUMBER\n  AND loc2.ASSEMBLY_ITEM_NUMBER    = loc.ASSEMBLY_ITEM_NUMBER\n  ) AS designatorList\nFROM V_PARTUSAGELINK_LOC loc\nWHERE loc.ASSEMBLY_ITEM_NUMBER = ?\nAND loc.COMPONENT_ITEM_NUMBER  = ?\n\n</code></pre>"},{"location":"Oracle_SQL/#xmlagg","title":"xmlagg","text":"<p>listagg\u8cc7\u6599\u904e\u9577\u6642\u9808\u8981\u6539\u7528xmlagg</p> <pre><code>SELECT loc.ASSEMBLY_ITEM_NUMBER,\n  loc.COMPONENT_ITEM_NUMBER,\n  loc.QUANTITY,\n  rtrim(extract(xmlagg(xmlelement(e, loc.DESIGNATOR\n  ||',')), '/E/text()').getclobval(), ',') designatorList\nFROM V_PARTUSAGELINK_LOC loc\nWHERE loc.ASSEMBLY_ITEM_NUMBER = ?\nAND loc.COMPONENT_ITEM_NUMBER  = ?\nGROUP BY loc.ASSEMBLY_ITEM_NUMBER,\n  loc.COMPONENT_ITEM_NUMBER,\n  loc.QUANTITY\n</code></pre>"},{"location":"java_temp/","title":"Java - temp","text":""},{"location":"java_temp/#_1","title":"\u672a\u5206\u985e","text":""},{"location":"java_temp/#_2","title":"\u672a\u5206\u985e","text":""},{"location":"java_temp/#1sort","title":"1.Sort","text":"<p>Sort the list based on level and actionName</p> <pre><code>public static void sortChangeList(List&lt;ChangeListUtil&gt; changeListReport) {  \n    Collections.sort(changeListReport, new Comparator&lt;ChangeListUtil&gt;() {\n        public int compare(ChangeListUtil o1, ChangeListUtil o2) {\n            String x1 = o1.getLevel() + \"\";\n            String x2 = o2.getLevel() + \"\";\n            int sComp = x1.compareTo(x2);\n            if (sComp != 0) {\n                return sComp;\n            }\n\n            String a1 = o1.getActionName();\n            String a2 = o2.getActionName();\n            return a2.compareTo(a1);\n        }\n    });\n}\n\n</code></pre>"},{"location":"windchill_changeOrder/","title":"Windchill - ChangeOrder","text":""},{"location":"windchill_changeOrder/#changeorder","title":"ChangeOrder \u8b8a\u66f4\u901a\u77e5","text":""},{"location":"windchill_changeOrder/#1","title":"1. \u8a73\u7d30\u8cc7\u8a0a","text":""},{"location":"windchill_changeOrder/#1-1-wtchangeorder2","title":"1-1. \u53d6\u5f97 WTChangeOrder2 \u4f01\u696d\u5c6c\u6027","text":"<pre><code>public static void test() throws Exception {\n    String ecno = \"C386210005\";\n    WTChangeOrder2 eco = ext.generic.util.ChangeUtil.getChangeNoticeByNumber(ecno, true);\n\n    String buName = (String) ext.mitac.report.util.IBAValueHelper.getIBAValue(eco, \"BUname\");\n    String description = eco.getDescription();\n\n    System.out.println(\"\u55ae\u64da\u865f\u78bc\uff1a\"+eco.getNumber());\n    System.out.println(\"\u55ae\u64da\u540d\u7a31\uff1a\"+eco.getName());\n    System.out.println(\"\u55ae\u64da\u5c6c\u6027(BU)\uff1a\"+buName);\n    System.out.println(\"\u55ae\u64da\u63cf\u8ff0\uff1a\"+description);\n}\n\n</code></pre>"},{"location":"windchill_changeOrder/#1-2-wtchangeorder2","title":"1-2. \u53d6\u5f97 WTChangeOrder2 \u55ae\u64da\u72c0\u614b","text":"<pre><code>\nString ecno = \"C386210005\";\nWTChangeOrder2 eco = ext.generic.util.ChangeUtil.getChangeNoticeByNumber(ecno, true);\nString ecnState = eco.getLifeCycleState().toString();\n\n</code></pre>"},{"location":"windchill_changeOrder/#1-3-changelistxls","title":"1-3. \u9644\u4ef6\u6a94\u6848 - \u4ee5 ChangeList.xls \u70ba\u4f8b","text":"<pre><code>\npublic static void test() throws Exception {\n    String ecno = \"C528210057\";\n    WTChangeOrder2 eco = ext.generic.util.ChangeUtil.getChangeNoticeByNumber(ecno, true);\n\n    //ChangeList.xls\n    File changeList = getChangeItem(eco);\n}\n\npublic static File getChangeItem(Object businessObject) throws WTException, IOException {\n    System.out.println(\"getChangeItem.....\");\n    String fileName = \"\";\n    List&lt;Object&gt; changeItemList = null;\n    WTChangeOrder2 co = (WTChangeOrder2) businessObject;\n    InputStream is = null;\n    QueryResult qr = null;\n    qr = ContentHelper.service.getContentsByRole(co, ContentRoleType.SECONDARY);\n    ApplicationData ap = null;\n    while (qr.hasMoreElements()) {\n        Object o = qr.nextElement();\n        if (o instanceof ApplicationData) {\n            ap = (ApplicationData) o;\n            fileName = ap.getFileName();\n            if (fileName.startsWith(\"ChangeList_\")\n                    &amp;&amp; fileName.endsWith(\".xls\")) {\n                qr = null;\n                break;\n            }\n            ap = null;\n        }\n    }\n\n    if (ap == null) {\n        return null;\n    }\n\n    is = ContentServerHelper.service.findContentStream(ap);\n    if (is == null) {\n        throw new WTException(\"Could not get input stream from content file!\");\n    }\n\n    WTProperties wtproperties = WTProperties.getServerProperties();\n    String filepath = wtproperties.getProperty(\"mitac.report.download.path\");\n\n    String path = filepath + fileName; // \u6293\u53d6\u6a94\u6848\u5b58\u653e\u8def\u5f91\n    File file = new File(path);\n    FileUtils.copyInputStreamToFile(is, file);\n    return file;\n}\n\n</code></pre>"},{"location":"windchill_changeOrder/#2","title":"2. \u5be6\u884c\u8a08\u756b","text":""},{"location":"windchill_changeOrder/#2-1","title":"2-1. \u53d6\u5f97 \u53d7\u5f71\u97ff\u7269\u4ef6","text":"<pre><code>public static void test() throws Exception {\n\n    String ecno = \"C386210005\";\n    WTChangeOrder2 eco = ext.generic.util.ChangeUtil.getChangeNoticeByNumber(ecno, true);\n\n    // \u53d7\u5f71\u97ff\u7269\u4ef6\n    List&lt;Changeable2&gt; beforChangeableList =  ext.generic.util.ChangeUtil.getChangeNoticeItemsBefore(eco);\n    for(Changeable2 obj :beforChangeableList) {\n      if (obj instanceof ManufacturerPart) {\n        ManufacturerPart mpart = (ManufacturerPart) obj;\n          System.out.println(\"mpart:\"+mpart.getNumber());\n          String makerCode = ext.mitac.integration.erp.CommandUtil.getMakerCode(mpart);\n          System.out.println(\"makerCode1:\"+makerCode);\n        }else if(obj instanceof WTPart){\n          WTPart wtPart = (WTPart) obj;\n            System.out.println(\"WTPart:\"+wtPart.getNumber());\n        }\n    }\n}\n\n</code></pre>"},{"location":"windchill_changeOrder/#2-2","title":"2-2. \u53d6\u5f97 \u7522\u751f\u7269\u4ef6","text":"<pre><code>\npublic static void test() throws Exception {\n    String ecno = \"C386210005\";\n    WTChangeOrder2 eco = ext.generic.util.ChangeUtil.getChangeNoticeByNumber(ecno, true);\n    // \u7522\u751f\u7269\u4ef6\u3001\u7d50\u679c\u7269\u4ef6\n    List&lt;Changeable2&gt; afterChangeableList =  ext.generic.util.ChangeUtil.getChangeablesAfter(eco);\n    for(Changeable2 obj :afterChangeableList) {\n        if (obj instanceof ManufacturerPart) {\n            ManufacturerPart mpart = (ManufacturerPart) obj;\n            System.out.println(\"mpart:\"+mpart.getNumber());\n            String makerCode = ext.mitac.integration.erp.CommandUtil.getMakerCode(mpart);\n            System.out.println(\"makerCode1:\"+makerCode);\n        }else if(obj instanceof WTPart){\n            WTPart wtPart = (WTPart) obj;\n            System.out.println(\"WTPart:\"+wtPart.getNumber());\n        }\n    }\n}\n\n</code></pre>"},{"location":"windchill_changeOrder/#3-part","title":"3. \u8b8a\u66f4 (\u5230\u6642\u5019\u79fb\u5230Part \u5167)","text":""},{"location":"windchill_changeOrder/#3-1","title":"3-1. \u53d6\u5f97 \u6e90\u65bc\u8b8a\u66f4\u901a\u77e5","text":"<pre><code>\nwt.fc.QueryResult affectCNs = wt.change2.ChangeHelper2.service\n        .getLatestUniqueImplementedChangeOrders((wt.change2.Changeable2) part);\n\nwhile (affectCNs.hasMoreElements()) {\n    wt.change2.WTChangeOrder2 ecn = (wt.change2.WTChangeOrder2) affectCNs.nextElement();            \n}\n\n</code></pre>"},{"location":"windchill_doc/","title":"Windchill - DOC","text":""},{"location":"windchill_doc/#wtdocument","title":"WTDocument","text":"<pre><code>public static void test() throws Exception {\n\n    String number = \"0000725876\";\n    WTDocument doc = getLastestWTDocument(number);\n    String name = doc.getName();\n    String vers = doc.getVersionInfo().getIdentifier().getValue();\n    String iter = doc.getIterationInfo().getIdentifier().getValue();\n    System.out.println(\"\u6587\u4ef6\u540d\u7a31\uff1a\"+ name);\n    System.out.println(\"\u6587\u4ef6\u7248\u672c\uff1a\"+ vers);\n    System.out.println(\"\u6587\u4ef6\u7248\u5e8f\uff1a\"+ iter);\n}\n\npublic static WTDocument getLastestWTDocument(String number) throws Exception{\n\n    WTDocumentMaster master = new WTDocumentMaster();\n    QuerySpec lqs = new QuerySpec(WTDocumentMaster.class);\n    lqs.appendSearchCondition(new SearchCondition(WTDocumentMaster.class, WTDocumentMaster.NUMBER, SearchCondition.EQUAL, number, false));\n    QueryResult results = PersistenceHelper.manager.find(lqs);\n    while (results.hasMoreElements()) {\n      master = (WTDocumentMaster) results.nextElement();\n    }\n\n    QueryResult queryResult = wt.vc.VersionControlHelper.service.allVersionsOf(master);\n    WTDocument rc = null;\n    while (queryResult.hasMoreElements()) {\n      WTDocument obj = ((WTDocument) queryResult.nextElement());\n        if (!wt.vc.wip.WorkInProgressHelper.isWorkingCopy(obj)) {\n            if (rc == null || obj.getVersionIdentifier().getSeries().greaterThan(rc.getVersionIdentifier().getSeries())) {\n                rc = obj;\n            }\n        }\n    }\n    if (rc != null) {\n        return (WTDocument) wt.vc.VersionControlHelper.getLatestIteration(rc);\n    } else {\n        return rc;\n    }\n}\n</code></pre> <pre><code>public static void test() throws Exception {\n\n    String number = \"0000725876\";\n    List&lt;WTDocument&gt; docList = getWTDocument(number);\n}\n\npublic static List&lt;WTDocument&gt; getWTDocument(String number) throws WTException {\n    List&lt;WTDocument&gt; docs = new ArrayList&lt;WTDocument&gt;();\n    QuerySpec lqs = new QuerySpec(WTDocument.class);\n    lqs.appendSearchCondition(new SearchCondition(WTDocument.class, WTDocument.NUMBER, SearchCondition.LIKE, number, false));\n    QueryResult results = PersistenceHelper.manager.find(lqs);\n    while (results.hasMoreElements()) {\n      WTDocument doc = (WTDocument) results.nextElement();\n      docs.add(doc);\n    }\n    return docs;\n}\n</code></pre> <pre><code>  -- \u522a\u9664 Part Document\n  --1.\u67e5 \u6240\u6709\u95dc\u806f\u7684 \u7248\u672c/\u5e8f\n  --select count(*),makerpn,maker_code from (\n  select distinct\n    mpm.wtpartnumber as makerpn\n    ,substr(org.name,1,instr(org.name,'(',1,1)-1) as maker_code\n    ,mp.statestate as makerpart_state\n    ,mp.modifystampa2\n    ,mp.versionida2versioninfo\n    ,mp.iterationida2iterationinfo\n    ,wdm.wtdocumentnumber as docnumber\n    ,wd.versionida2versioninfo\n    ,wd.iterationida2iterationinfo\n    ,wd.statestate as partdoc_state\n    ,lnk.ida2a2\n  from manufacturerpart mp, manufacturerpartmaster mpm, WTPartReferenceLink lnk,wtdocument wd, wtdocumentmaster wdm --, v_lastestwtdocument vld,\n      ,WTOrganization org --, axlentry ax, wtpart wp, wtpartmaster wpm, v_lastestwtpart vl\n  where\n    mp.ida3masterreference = mpm.ida2a2 and mp.ida2a2 = lnk.ida3a5 and lnk.ida3b5 = wdm.ida2a2\n    --and ax.ida3c4 = wp.ida2a2 and wp.ida2a2 = vl.wp_ida2a2 and vl.wpm_ida2a2 = wpm.ida2a2\n    --and ax.ida3a4 = mpm.ida2a2\n    and mpm.ida3organizationreference = org.ida2a2\n    --and ax.amlpreferencedata in (70,80)\n    and wdm.ida2a2 = wd.ida3masterreference\n    --and wp.statestate &lt;&gt; 'PHASEOUT' --)\n    --and mp.statestate = 'CHANGE_IN_WORK'\n    --group by makerpn,maker_code\n    --and mpm.wtpartnumber = '2215D6740002'\n    and wdm.wtdocumentnumber in ('0000349514','0000355577','0000982683','0000605342')\n  order by 1,5,6;\n\n  --2.\u522a\u9664 WTPartReferenceLink \u95dc\u806f\n  select t.*,t.rowid\n  from WTPartReferenceLink t\n  where t.ida2a2 in (\n    select lnk.ida2a2\n    from manufacturerpart mp, manufacturerpartmaster mpm, WTPartReferenceLink lnk,wtdocument wd, wtdocumentmaster wdm --, v_lastestwtdocument vld\n    , WTOrganization org --, axlentry ax, wtpart wp, wtpartmaster wpm, v_lastestwtpart vl\n    where mp.ida3masterreference = mpm.ida2a2 and mp.ida2a2 = lnk.ida3a5 and lnk.ida3b5 = wdm.ida2a2\n    --and ax.ida3c4 = wp.ida2a2 and wp.ida2a2 = vl.wp_ida2a2 and vl.wpm_ida2a2 = wpm.ida2a2\n    --and ax.ida3a4 = mpm.ida2a2\n    and mpm.ida3organizationreference = org.ida2a2\n    --and ax.amlpreferencedata in (70,80)\n    and wdm.ida2a2 = wd.ida3masterreference\n    --and wp.statestate &lt;&gt; 'PHASEOUT' --)\n    --and mp.statestate = 'CHANGE_IN_WORK'\n    --group by makerpn,maker_code\n    --and mpm.wtpartnumber = 'TPD4S010DQAR'\n    and wdm.wtdocumentnumber in ('0000845570','0000846005')\n  );\n\n  delete from WTPartReferenceLink t where t.ida2a2 in (\n    select distinct lnk.ida2a2\n    from manufacturerpart mp, manufacturerpartmaster mpm, WTPartReferenceLink lnk,wtdocument wd, wtdocumentmaster wdm --, v_lastestwtdocument vld\n    , WTOrganization org --, axlentry ax, wtpart wp, wtpartmaster wpm, v_lastestwtpart vl\n    where mp.ida3masterreference = mpm.ida2a2 and mp.ida2a2 = lnk.ida3a5 and lnk.ida3b5 = wdm.ida2a2\n    --and ax.ida3c4 = wp.ida2a2 and wp.ida2a2 = vl.wp_ida2a2 and vl.wpm_ida2a2 = wpm.ida2a2\n    --and ax.ida3a4 = mpm.ida2a2\n    and mpm.ida3organizationreference = org.ida2a2\n    --and ax.amlpreferencedata in (70,80)\n    and wdm.ida2a2 = wd.ida3masterreference\n    --and wp.statestate &lt;&gt; 'PHASEOUT' --)\n    --and mp.statestate = 'CHANGE_IN_WORK'\n    --group by makerpn,maker_code\n    --and mpm.wtpartnumber = 'TPD4S010DQAR'\n    and wdm.wtdocumentnumber in ('0000349514')\n  );\n</code></pre>"},{"location":"windchill_doc/#1-wtdocument","title":"1.\u4f9d\u7167\u6587\u4ef6\u7de8\u865f\uff0c\u53d6\u5f97 WTDocument \u7269\u4ef6(\u6700\u65b0\u7248\u672c\u7248\u5e8f)","text":""},{"location":"windchill_doc/#2-wtdocument","title":"2.\u4f9d\u7167\u6587\u4ef6\u7de8\u865f\uff0c\u53d6\u5f97 WTDocument \u7269\u4ef6 (\u6240\u6709\u7248\u672c\u7248\u5e8f)","text":""},{"location":"windchill_doc/#3-part-document","title":"3.\u522a\u9664 Part Document \u7684\u95dc\u806f","text":""},{"location":"windchill_doc/#4-part-document-yushu","title":"4.\u522a\u9664 Part Document \u6587\u4ef6 (yushu\u7248)","text":"<pre><code>--\u67e5\u8a62\u6240\u6709\u8207\u8a72 Part Document \u6709\u95dc\u4e4b\u95dc\u806fID:                         \nselect ida2a2 from WTPartReferenceLink where ida3b5 in (                            \n  select ida2a2 from wtdocumentmaster                           \n  where wtdocumentnumber in ('0000605342','0000355577','0000349514','0000982683')                           \n)\n\n--\u522a\u9664\u8a72 Part Document \u6240\u6709\u95dc\u806f:                           \nDelete from WTPartReferenceLink                             \nwhere ida2a2 in(                            \n  select ida2a2 from WTPartReferenceLink where ida3b5 in (                          \n    select ida2a2 from wtdocumentmaster                             \n    where wtdocumentnumber in ('0000605342','0000355577','0000349514','0000982683')                         \n  )                         \n)\n\n--\u7136\u5f8c\u5230 PLM \u9801\u9762\u4e0a\u522a\u9664\u9019\u4e9b\u6587\u4ef6\n</code></pre>"},{"location":"windchill_doc/#wtdocument_1","title":"WTDocument \u51fa\u5eab\u5165\u5eab","text":"<pre><code>String docNum = \"0001154314\";\nWTDocument doc = DocumentUtil.getLastestWTDocument(docNum);\nWorkable work = doc;\nFolder folder = WorkInProgressHelper.service.getCheckoutFolder();\nCheckoutLink checkoutLink = WorkInProgressHelper.service.checkout(work, folder, \"Auto CheckOut by System.\");\nwork = checkoutLink.getWorkingCopy();\nwork = WorkInProgressHelper.service.checkin(work, \"check in msg\"); \n\n</code></pre>"},{"location":"windchill_doc/#1wtdocument","title":"1.WTDocument \u53d6\u5f97\u51fa\u5eab\u4eba\u54e1\u4e26\u6062\u5fa9\u51fa\u5eab","text":"<pre><code>    String docNum = \"0001154314\";\n        WTDocument doc = DocumentUtil.getLastestWTDocument(docNum);\n\n    if (WorkInProgressHelper.isCheckedOut(doc)) {\n            if(\"Administrator\".equals(doc.getLockerName())) {\n                WorkInProgressHelper.service.undoCheckout(doc);\n            }\n        }\n\n</code></pre> <pre><code>    public static WTDocument getLastestWTDocument(String number) throws Exception {\n        WTDocumentMaster master = new WTDocumentMaster();\n        QuerySpec lqs = new QuerySpec(WTDocumentMaster.class);\n        lqs.appendSearchCondition(new SearchCondition(WTDocumentMaster.class, WTDocumentMaster.NUMBER,\n                SearchCondition.EQUAL, number, false));\n        QueryResult results = PersistenceHelper.manager.find(lqs);\n        while (results.hasMoreElements()) {\n            master = (WTDocumentMaster) results.nextElement();\n        }\n\n        QueryResult queryResult = wt.vc.VersionControlHelper.service.allVersionsOf(master);\n        WTDocument rc = null;\n        while (queryResult.hasMoreElements()) {\n            WTDocument obj = ((WTDocument) queryResult.nextElement());\n            if (!wt.vc.wip.WorkInProgressHelper.isWorkingCopy(obj)) {\n                if (rc == null\n                        || obj.getVersionIdentifier().getSeries().greaterThan(rc.getVersionIdentifier().getSeries())) {\n                    rc = obj;\n                }\n            }\n        }\n\n        if (rc != null) {\n            return (WTDocument) wt.vc.VersionControlHelper.getLatestIteration(rc);\n        } else {\n            return rc;\n        }\n    }\n\n</code></pre>"},{"location":"windchill_ec/","title":"Windchill ec","text":""},{"location":"windchill_ec/#ec","title":"EC","text":""},{"location":"windchill_ec/#_1","title":"\u7522\u751f\u7269\u4ef6","text":""},{"location":"windchill_ec/#1","title":"1.\u53d6\u5f97\u7522\u751f\u7269\u4ef6","text":"<p>\u6e2c\u8a66\u8aaa\u660e</p> <pre><code>&lt;!-- Tiles2 --&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;org.apache.struts&lt;/groupId&gt;\n    &lt;artifactId&gt;struts2-tiles-plugin&lt;/artifactId&gt;\n    &lt;version&gt;2.3.8&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre>"},{"location":"windchill_ec/#2","title":"2.\u79fb\u9664\u7522\u751f\u7269\u4ef6","text":"<p>\u6e2c\u8a66\u8aaa\u660e94\u8981\u8aaa\u660e</p> <pre><code>&lt;!-- Tiles2 --&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;org.apache.struts&lt;/groupId&gt;\n    &lt;artifactId&gt;struts2-tiles-plugin&lt;/artifactId&gt;\n    &lt;version&gt;2.3.8&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre>"},{"location":"windchill_ec/#_2","title":"\u53d7\u5f71\u97ff\u7269\u4ef6","text":""},{"location":"windchill_ec/#1_1","title":"1.\u53d7\u5f71\u97ff\u7269\u4ef6","text":"<p>\u6e2c\u8a66\u8aaa\u660e</p> <pre><code>&lt;!-- Tiles2 --&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;org.apache.struts&lt;/groupId&gt;\n    &lt;artifactId&gt;struts2-tiles-plugin&lt;/artifactId&gt;\n    &lt;version&gt;2.3.8&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre>"},{"location":"windchill_ec/#2_1","title":"2.\u53d7\u5f71\u97ff\u7269\u4ef6","text":"<p>\u6e2c\u8a66\u8aaa\u660e94\u8981\u8aaa\u660e</p> <pre><code>&lt;!-- Tiles2 --&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;org.apache.struts&lt;/groupId&gt;\n    &lt;artifactId&gt;struts2-tiles-plugin&lt;/artifactId&gt;\n    &lt;version&gt;2.3.8&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre>"},{"location":"windchill_project/","title":"Windchill - Project","text":""},{"location":"windchill_project/#project","title":"Project","text":""},{"location":"windchill_project/#1-project","title":"1. Project","text":""},{"location":"windchill_project/#2-product","title":"2. Product","text":""},{"location":"windchill_project/#2-1-product","title":"2-1. \u53d6\u5f97 Product","text":"<p>\u4f9d\u7167ID\u53d6\u5f97 Product </p> <pre><code>\npublic static PDMLinkProduct getProductById(long pdId) throws WTException {\n    QuerySpec queryspec = new QuerySpec(PDMLinkProduct.class);\n    SearchCondition searchcondition = new SearchCondition(\n            PDMLinkProduct.class, \"thePersistInfo.theObjectIdentifier.id\",\n            SearchCondition.EQUAL, pdId);\n    queryspec.appendWhere(searchcondition, new int[] { 0 });\n    QueryResult queryresult = PersistenceHelper.manager.find(queryspec);\n\n    if (!queryresult.hasMoreElements()) {\n        System.out.println(\"No product found\");\n    } else {\n        return (PDMLinkProduct) queryresult.nextElement();\n    }\n\n    return null;\n}\n\n</code></pre> <p>\u4f9d\u7167 ContainerRef String \u53d6\u5f97 Product</p> <pre><code>\nPDMLinkProduct product = ext.util.ProductUtil.getProductByContainerRef(doc.getContainerReference().toString());\n\n//input:WTDocument doc.getContainerReference().toString()   \npublic static PDMLinkProduct getProductByContainerRef(String docContainerRef) {\n    PDMLinkProduct product = null;\n    try {\n        if(docContainerRef.indexOf(\"wt.pdmlink.PDMLinkProduct\") &gt; -1) {\n            String[] tempArr = docContainerRef.split(\":\");\n            String productId = tempArr.length&gt;1 ? tempArr[1]:\"\";\n            if(!StringUtils.isBlank(productId)) {\n                product = getProductById(Long.parseLong(productId));\n            }\n        }\n    } catch (WTException e) {\n        e.printStackTrace();\n        System.out.println(\"getProductByContainerRef error\");\n    }\n    return product;\n}\n\n</code></pre> <p>\u4f9d\u7167 product name \u53d6\u5f97 Product</p> <pre><code>\npublic static PDMLinkProduct getProduct(String pdName) {\n    PDMLinkProduct product = null;\n    try {\n        String productId = getProductId(pdName);\n        if(StringUtils.isBlank(productId)) {\n            return null;\n        }\n\n        product = getProductById(productId);\n    } catch (WTException e) {\n        e.printStackTrace();\n    }\n\n    return product;\n}\n\n\npublic static String getProductId(String name) {\n    try {\n        List&lt;Map&lt;String, Object&gt;&gt; maps = DBUtil.queryRows(\"select ida2a2 from PDMLinkProduct where NAMECONTAINERINFO = ?\", \n                new ArrayList(Arrays.asList(name)), \"\");\n        return DBUtil.getFirstRowValue(maps, \"ida2a2\");  \n    } catch (Exception exp) {\n        exp.printStackTrace();\n    }\n\n    return \"\";\n}\n\n</code></pre>"},{"location":"windchill_project/#2-2-project-code","title":"2-2. \u53d6\u5f97 Project code","text":"<p>\u53d6\u5f97 Product \u7684 Project code</p> <pre><code>\npublic static String getProjectCode(PDMLinkProduct product) {\n    if(Objects.isNull(product))\n        return StringUtils.EMPTY;\n    try {\n        return new IBAUtility(product).getIBAValue(IbaEnum.PROJECT_CODE.getName());\n    } catch (WTException e) {\n        e.printStackTrace();\n        return StringUtils.EMPTY;\n    }\n}\n\n</code></pre>"},{"location":"windchill_project/#3-model","title":"3. Model","text":""},{"location":"windchill_project/#4-team","title":"4. Team","text":"<p>\u6b64\u6210\u54e1\u4ee3\u8868\u7522\u54c1\u5e95\u4e0b\u6210\u54e1\uff0c\u4e26\u975e\u8def\u7531\u8655\u7406\u7d00\u9304\u4e4b\u6210\u54e1</p>"},{"location":"windchill_project/#4-1-get-users-by-role","title":"4-1. get Users by role","text":"<p>\u6839\u64darole id \u6216 role \u6488\u53d6\u7522\u54c1\u5e95\u4e0b\u6210\u54e1</p> <pre><code>\npublic static List&lt;WTPrincipalReference&gt; getUsersByRole(PDMLinkProduct product, Role role) {\n        ArrayList&lt;WTPrincipalReference&gt; users = new ArrayList&lt;&gt;();\n        try {\n            ContainerTeam containerTeam = ContainerTeamHelper.service.getContainerTeam(product);\n            return containerTeam.getAllPrincipalsForTarget(role);\n        } catch (WTException e) {\n            e.printStackTrace();\n            System.out.println(\"getUsersByRole error. product name:\"+product.getProductName());\n            return users;\n        }   \n    }\n\npublic static List&lt;WTPrincipalReference&gt; getUsersByRole(PDMLinkProduct product, String roleName) {\n    return getUsersByRole(product, _Role.toRole(roleName));\n}\n\n</code></pre>"},{"location":"windchill_project/#4-2-users-to-role","title":"4-2. \u589e\u52a0 Users to role","text":"<p>\u589e\u52a0 Users to teams</p> <pre><code>\npublic static String addUser(PDMLinkProduct product, String roleName, String acc) {\n    String errMsg = \"\";\n    if(null == product)\n        return \"product is null\";\n    if(StringUtils.isBlank(roleName) || StringUtils.isBlank(acc))\n        return \"roleName or acc is null\";\n    WTUser newUser = PrincipalUtil.getUserByName(acc);\n    Role role = _Role.toRole(roleName);\n    try {\n        ContainerTeamHelper.service.addMember(ContainerTeamHelper.service.getContainerTeam(product), role, newUser);\n        PersistenceHelper.manager.save(product);\n        PersistenceHelper.manager.refresh(product);\n    } catch (WTException e) {\n        e.printStackTrace();\n    }\n\n    return errMsg;\n}\n\n</code></pre>"},{"location":"windchill_project/#4-3-users","title":"4-3. \u522a\u9664 Users","text":"<pre><code>\npublic static String removeUser(PDMLinkProduct product, String roleName, String acc) {\n    String errMsg = \"\";\n    if(null == product)\n        return \"product is null\";\n    if(StringUtils.isBlank(roleName) || StringUtils.isBlank(acc))\n        return \"roleName or acc is null\";\n    if(\"wcadmin\".equalsIgnoreCase(acc)) {\n        acc = \"Administrator\";\n    }\n    Role role = _Role.toRole(roleName);\n    try {\n        List&lt;WTPrincipalReference&gt; users = getUsersByRole(product, role);\n        for(WTPrincipalReference user : users) {\n            if(acc.equals(user.getIdentity())) {\n                ContainerTeamHelper.service.removeMember(ContainerTeamHelper.service.getContainerTeam(product), \n                        role, user.getPrincipal());\n                PersistenceHelper.manager.save(product);\n                PersistenceHelper.manager.refresh(product);\n                break;\n            }\n        }\n    } catch (WTException e) {\n        e.printStackTrace();\n    }\n    return errMsg;\n}\n\n</code></pre>"},{"location":"windchill_project/#4-4","title":"4-4. \u662f\u5426\u70ba \u5c08\u6848\u5718\u968a","text":"<p>\u5224\u65b7\u662f\u5426\u70ba\u5c08\u6848\u5718\u968a</p> <pre><code>\npublic static boolean isTeamMember(PDMLinkProduct product, String acc) {\n    if(product==null || StringUtils.isBlank(acc)) {\n        return false;\n    }\n\n    if(\"wcadmin\".equalsIgnoreCase(acc)) {\n        acc = \"Administrator\";\n    }\n\n    try {\n        ContainerTeam team =ContainerTeamHelper.service.getContainerTeam(product);\n        HashMap&lt;?, ?&gt; hm= team.getAllMembers();\n        for(Object key:hm.keySet()) {\n            WTPrincipalReference user = (WTPrincipalReference) key;\n            if(acc.equals(user.getName()))\n                return true;\n        }\n    } catch (WTException e) {\n        e.printStackTrace();\n    }\n\n    return false;\n}\n\n</code></pre>"},{"location":"windchill_workflow/","title":"Windchill - Workfolw","text":""},{"location":"windchill_workflow/#workflow","title":"Workflow","text":""},{"location":"windchill_workflow/#1","title":"1. \u89d2\u8272","text":""},{"location":"windchill_workflow/#1-1-wf","title":"1-1. \u65bcWF\u65b0\u589e\u89d2\u8272","text":"<p>\u82e5\u9808\u65bcWF\u5167\u89d2\u8272\u6e05\u55ae\u5167\u65b0\u589e\u81ea\u5b9a\u7fa9\u89d2\u8272\uff0c\u9700\u65bc\u4e0b\u9762\u8a2d\u5b9a\u6a94\u8a2d\u5b9a Windchill/wtCustom/wt/project/RoleRB.rbInfo Windchill/wtCustom/wt/project/RoleRB_zh_TW.rbInfo</p> <p>\u8a2d\u5b9a\u503c\u5982\u4e0b\uff0c\u5176\u4e2dorder\u865f\u78bc\u6bcf\u6b21\u8df3\u865f64\uff0c\u5176\u4e2dMI_ENGINEER\u70baKEY</p> <pre><code>MI_ENGINEER.value=MI Engineer\nMI_ENGINEER.shortDescription=MI Engineer\nMI_ENGINEER.order=9424\n</code></pre>"},{"location":"windchill_workflow/#1-2","title":"1-2. \u589e\u52a0 \u6210\u54e1","text":"<p>\u65bc\u55ae\u64da\u4e2d(\u8def\u7531/\u8655\u7406\u7d00\u9304)\u89d2\u8272\u5167\u589e\u52a0\u6210\u54e1 \u4e0b\u9762\u7684roleName\u6307\u7684\u662fkey key\u503c\u53ef\u53c3\u8003\\Windchill_11.0\\Windchill\\wtCustom\\wt\\project\\RoleRB.rbInfo \u5927\u5c0f\u5beb\u654f\u611f</p> <pre><code>\nWorkflowUtil.addPrincipalToRole(self, roleName, userAd);\n\npublic static void addPrincipalToRole(Object processObj, String roleName, String strUserID) throws WTException {\n    WTPrincipal principal = (WTPrincipal)wt.org.OrganizationServicesHelper.manager.getPrincipal(strUserID);\n    if (processObj == null || roleName == null || roleName.length() == 0 || principal == null)\n        return;\n    else\n        addPrincipalToRole(processObj, roleName, principal);\n}\n\npublic static void addPrincipalToRole(Object processObj, String roleName, WTPrincipal principal) throws WTException {\n    if (processObj == null || roleName == null || roleName.length() == 0 || principal == null)\n        return;\n    Team team = null;\n    WfProcess wfprocess = getProcess(processObj);\n    wt.team.TeamReference teamreference = wfprocess.getTeamId();\n    team = (Team) teamreference.getObject();\n    Role role = Role.toRole(roleName);\n\n    //String originalUser = principal.getName();\n    //String replaceUser = CommonUtil.mappingTMSUserName(originalUser); //Get mapping user from TMS_USER_MAPPING table.\n    //principal = OrganizationServicesHelper.manager.getPrincipal(replaceUser); //replace principal\n\n    team.addPrincipal(role, principal);\n    //System.out.println(\"ext.generic.uril.WorkflowUtil.addPrincipalToRole: Replace = \" + originalUser + \" change to \" + replaceUser);\n    //System.out.println(\".........\" + principal.getName());\n    team = (Team) PersistenceHelper.manager.refresh(team);\n    team = (Team) PersistenceHelper.manager.save(team);\n    System.out.println(\"ext.generic.uril.WorkflowUtil.addPrincipalToRole: roleName = \" + roleName + \"-User=\" + principal.getName());\n}\n\n\n</code></pre>"},{"location":"windchill_workflow/#1-3","title":"1-3. \u522a\u9664 \u6210\u54e1","text":"<p>\u65bc\u55ae\u64da\u4e2d(\u8def\u7531/\u8655\u7406\u7d00\u9304)\u89d2\u8272\u5167\u522a\u9664\u6210\u54e1 \u4e0b\u9762\u7684roleName\u6307\u7684\u662fkey</p> <pre><code>\nTeamUtil.removeUser(pbo, Arrays.asList(PROJECT_LEADER, L9_PM, SALES, PMP_ENGINEER));\n\npublic static String removeUser(WTObject pbo, List&lt;String&gt; roleNameList) {\n    StringBuilder sb = new StringBuilder();\n    for(int i = 0; i&lt;roleNameList.size(); i++){\n        sb.append(removeUser(pbo, roleNameList.get(i)));\n    }\n\n    String msg = sb.toString();\n    sb.setLength(0);\n    return msg;\n}\n\n\npublic static String removeUser(WTObject pbo, String roleName) {\n    String msg = \"\";\n    try {\n        Team team = ext.mitac.ecm.WorkflowUtil.getTeam(pbo);\n        Role role = _Role.toRole(roleName);\n        team = ext.mitac.ecm.WorkflowUtil.refreshTeam_FromDB(team);\n        Enumeration rolePrincipals = team.getPrincipalTarget(role);\n        boolean hasPrincipals = false;\n        while (rolePrincipals.hasMoreElements()) {\n            WTPrincipalReference prnplRef = (WTPrincipalReference) rolePrincipals.nextElement();\n            hasPrincipals = true;\n        }\n\n        if (hasPrincipals) {\n            team.deleteRole(role);\n        }\n    } catch (Exception e) {\n        msg = \"removeUser error roleName:\"+roleName;\n        e.printStackTrace();\n    }\n\n    return msg;\n}\n\n</code></pre>"},{"location":"windchill_workflow/#2","title":"2. \u6295\u7968","text":""},{"location":"windchill_workflow/#2-1","title":"2-1. \u53d6\u5f97\u8def\u7531/\u8655\u7406\u7d00\u9304\u5167\u6307\u5b9a\u89d2\u8272\u7684\u6210\u54e1","text":"<p>getRolePrincipal(eco,\"QE(PCBA) ENGINEER\") QE(PCBA) ENGINEER\u70ba\u6d41\u7a0b\u72c0\u6cc1\u4e2d\u7684\u540d\u7a31</p> <pre><code>public static ArrayList&lt;WTPrincipal&gt; getRolePrincipal(WTChangeOrder2 eco,String roleName) throws WTException {\n    ArrayList&lt;WTPrincipal&gt; list = new ArrayList&lt;WTPrincipal&gt;();\n    wt.team.Team team = (wt.team.Team) eco.getTeamId().getObject();\n    Vector&lt;Role&gt; roles = team.getRoles();\n    java.util.Enumeration principals;\n    try {\n      principals = team.getPrincipalTarget(wt.project.Role.toRole(roleName));\n      while(principals.hasMoreElements())\n      {\n        wt.org.WTPrincipalReference principalRef = (wt.org.WTPrincipalReference)principals.nextElement();\n        wt.org.WTPrincipal wtprincipal = principalRef.getPrincipal();\n        list.add(wtprincipal);\n      }\n    } catch (WTInvalidParameterException | WTException e) {\n      e.printStackTrace();\n    } // replace the role KEY appropriately\n\n    return list;\n}\n</code></pre>"},{"location":"windchill_workflow/#2-2","title":"2-2. \u53d6\u5f97\u8def\u7531/\u8655\u7406\u7d00\u9304\u5167\u6307\u5b9a\u89d2\u8272\u5be6\u969b\u7c3d\u6838\u4eba\u54e1","text":"<p>getVotePerson(eco,\"QE-MB\") QE-MB\u70ba\u6d41\u7a0b\u72c0\u6cc1\u4e2d\u7684\u89d2\u8272</p> <pre><code>public static Set&lt;String&gt; getVotePerson(WTChangeOrder2 eco,String roleName) throws WTException {\n    Set&lt;String&gt; votors = new HashSet&lt;String&gt;();\n    WTContainer wtContainer = eco.getContainer();\n    QueryResult wfs = WfEngineHelper.service.getAssociatedProcesses(eco, null, WTContainerRef.newWTContainerRef(wtContainer));\n        if (wfs.size() &gt; 0){\n        while(wfs.hasMoreElements()){\n            WfProcess wfprocess = (WfProcess)wfs.nextElement();\n            QueryResult qrWfVotingEventAudits = NmWorkflowHelper.service.getVotingEventsForProcess(wfprocess);\n            while (qrWfVotingEventAudits != null &amp;&amp; qrWfVotingEventAudits.hasMoreElements()) {\n                WfVotingEventAudit wfvotingeventaudit = (WfVotingEventAudit) qrWfVotingEventAudits.nextElement();\n                WTPrincipalReference wtprincipalreference = wfvotingeventaudit.getAssigneeRef();\n                WTPrincipal wtprincipal = null;\n                if (wtprincipalreference != null) {\n                    wtprincipal = (WTPrincipal) wtprincipalreference.getObject();\n                }\n                String displayRole = \"\";\n                if(wfvotingeventaudit.getRole()!=null){\n                    displayRole = wfvotingeventaudit.getRole().getDisplay(Locale.ENGLISH);\n                }\n                System.out.println(\"displayRole:\" + displayRole);\n                if(roleName.equalsIgnoreCase(displayRole)) {\n                    votors.add(wtprincipal.getName());\n                }\n            }\n        }\n    }\n    return votors;\n}\n</code></pre>"},{"location":"windchill_workflow/#2-3-sql","title":"2-3. \u67e5\u8a62\u81ea\u52d5\u7c3d\u6838\u7684\u6295\u7968\u72c0\u6cc1 (SQL)","text":"<p>-- \u67e5\u8a62\u81ea\u52d5\u7c3d\u6838\u7684\u6295\u7968\u72c0\u6cc1</p> <pre><code>select Wv.*,sign.*\nfrom\n  PLM_AUTO_SIGN sign,\n  Wfprocess Wp,Wfassignedactivity Wfc,\n  Wfassignment Waa\n  left join Workitem Wi on Wi.Ida3c4 =  Waa.Ida2a2\n  right join (Select Activitykey, Activityname, Ida3a6, Role, Eventlist, Usercomment,Ida2a2 As Wv_Ida2a2 ,Ida3b6  From Wfvotingeventaudit) Wv on Wv.Ida3b6 = Wi.Ida2a2\nwhere Wp.Ida2a2 = Wfc.Ida3parentprocessref and Waa.Ida3a4 = Wfc.Ida2a2\nand Wp.ida2a2 = replace(sign.WF_PROCESS_OID,'OR:wt.workflow.engine.WfProcess:','')\nand Wfc.Name = sign.WF_ACTIVITYNAME order by sign.trx_id desc;\n</code></pre> <p>-- \u67e5\u8a62\u81ea\u52d5\u7c3d\u6838\u7684\u6295\u7968\u72c0\u6cc1 (\u4ee5\u524d\u7a31\u4f5c auto by pass\uff0c\u4f46\u56e0\u70ba\u7a3d\u6838\u554f\u984c\uff0c\u7d71\u4e00\u6539\u6210 by pass)</p> <pre><code>select ida2a2,Activitykey,Role,Eventlist,USERCOMMENT\nfrom Wfvotingeventaudit\nwhere USERCOMMENT='by pass';\n</code></pre>"},{"location":"windchill_workflow/#2-4-sql","title":"2-4. \u4fee\u6539\u7c3d\u6838\u4eba\u54e1\u7684\u8a3b\u89e3 (SQL)","text":"<p>-- \u4fee\u6539\u7c3d\u6838\u4eba\u54e1\u7684\u8a3b\u89e3</p> <pre><code>update Wfvotingeventaudit set USERCOMMENT='by pass' where ida2a2 = '8437249888' and USERCOMMENT='auto by pass';\nselect * from Wfvotingeventaudit where ida2a2 = '8437249888';\n\nupdate Wfvotingeventaudit set USERCOMMENT='by pass' where ida2a2 in (\n  select ida2a2 from Wfvotingeventaudit where USERCOMMENT='auto by pass'\n);\n\nselect ida2a2 from Wfvotingeventaudit where USERCOMMENT='by pass';\n</code></pre>"},{"location":"windchill_workflow/#3","title":"3","text":""},{"location":"windchill_workflow/#4","title":"4","text":""},{"location":"windchill_wtObject/","title":"Windchill - WTObject","text":""},{"location":"windchill_wtObject/#wtobject","title":"WTObject","text":""},{"location":"windchill_wtObject/#1-iba","title":"1. IBA","text":""},{"location":"windchill_wtObject/#1-1-iba","title":"1-1. \u53d6\u5f97IBA\u5c6c\u6027","text":"<p>\u53d6\u5f97IBA\u5c6c\u6027</p> <pre><code>ext.generic.util.IBAUtility iba = new ext.generic.util.IBAUtility((wt.doc.WTDocument) primaryBusinessObject);\nString ibaKey = \"applicant\";\nString ibaValue = iba.getIBAValue(ibaKey);\n\nString projectCode = new IBAUtility(product).getIBAValue(IbaEnum.PROJECT_CODE.getName());\n\n</code></pre>"},{"location":"windchill_wtObject/#1-2-iba","title":"1-2. \u66f4\u65b0IBA\u5c6c\u6027","text":"<pre><code>\npublic static void updateIba(WTPart part, String key, String value) throws WTException, WTPropertyVetoException, RemoteException{\n        WTPart checkOutPart = (WTPart)IBAUtility.checkOut(part);\n        IBAUtility iba = new IBAUtility(checkOutPart);\n        iba.setIBAValue(key, value);\n        iba.updateAttributeContainer(checkOutPart);\n        PersistenceHelper.manager.save(checkOutPart);\n        PersistenceHelper.manager.refresh(checkOutPart);\n        if(!WorkInProgressHelper.isCheckedOut(part)) {\n              IBAUtility.checkIn(part,\"update \"+key+\" to \" + value);\n    }\n}\n\n</code></pre>"},{"location":"windchill_wtObject/#1-3-iba-for","title":"1-3. \u53d6\u5f97/\u8a2d\u7f6eIBA\u5c6c\u6027 for \u591a\u91cd\u503c","text":"<pre><code>\npublic static void test() throws Exception {\n    //\u7576IBA\u5c6c\u6027\u70ba\u591a\u91cd\u503c\u6642\uff0c\u4e5f\u5c31\u662f\u8a72\u5c6c\u6027\u65bcPLM\u7ba1\u7406\u985e\u578b\u5167\u689d\u4ef6\u7d04\u675f\u7121\u55ae\u4e00\u503c\u7684\u689d\u4ef6\u9650\u5236\u6642\u70ba\u591a\u91cd\u503c\n    //\u53d6\u5f97IBA\u5c6c\u6027\n    String modelCode = \"8055\";\n    MiTACModel model = modelListUtil.getModel(modelCode);\n    String ibaKey = \"modelAttr2\";\n    IBAUtility iba = new IBAUtility(model);\n    Vector vec = iba.getIBAValues(ibaKey);\n    System.out.println(\"ibaKey:\"+ibaKey);\n    for(int i =0; i&lt;vec.size(); i++) \n        System.out.println(\"ibaValues i:\"+vec.get(i));\n\n    //\u8a2d\u7f6eIBA\u5c6c\u6027\n    Vector vecNew = new Vector();\n    vecNew.add(\"441N41400133\");\n    vecNew.add(\"441N64600005\");\n    model = (MiTACModel) modelListUtil.checkoutObject(model);\n    iba.setIBAValues(ibaKey, vecNew);\n    iba.updateAttributeContainer(model);\n    PersistenceHelper.manager.save(model);\n    PersistenceHelper.manager.refresh(model);\n    WorkInProgressHelper.service.checkin(model,\"\");\n}\n\n</code></pre>"},{"location":"windchill_wtObject/#1-4-ibakey-sql","title":"1-4. \u67e5\u8a62/\u4fee\u6539ibaKey\u503c SQL","text":"<pre><code>\n--\u53d6\u5f97\u6307\u5b9a\u6599\u865f\u7684\u76f8\u95dcIBA\u5c6c\u6027\u503c(middlePf\u9023\u7dda)\n--\u9664\u4e86 MV_STRINGVALUE_PART \u9084\u6709 MV_UnitVALUE_PART \u548c MV_TIMESTAMPVALUE_PART\nselect DISPLAYNAME, VALUE from MV_STRINGVALUE_PART \nwhere IDA3A4 = (\n    select wp_ida2a2 from mv_part where WTPARTNUMBER= '284260000006'\n)   \n\n--\u5229\u7528Model Desc\u67e5\u8a62\u5be6\u969b\u4e0a\u7684ibaKey\u503c\nselect distinct \n    sd.IDA2A2 -- stringvalue \u5167\u7684 ida3a6\u503c\n    , sd.DESCRIPTION -- \u9801\u9762\u4e0a\u7684IBA\u6b04\u4f4d\u540d\u7a31\n    , sd.NAME -- ibaKey\nfrom stringvalue sv, stringdefinition sd\nwhere sv.ida3a6 = sd.ida2a2\n    and sd.DESCRIPTION = 'Model Description'\norder by sd.IDA2A2\n\n--\u53d6\u5f97\u6307\u5b9a\u6599\u865f\u6700\u65b0\u7248\u672c\u4e4bIBA\u5c6c\u6027string\u985e\u5225\u7684ibaKey\u548cIbaValue\nselect distinct \n    sd.IDA2A2 -- stringvalue \u5167\u7684 ida3a6\u503c\n    , sd.DESCRIPTION -- \u9801\u9762\u4e0a\u7684IBA\u6b04\u4f4d\u540d\u7a31\n    , sd.NAME -- ibaKey\n    , sv.value2 -- value\u503c\nfrom stringvalue sv, stringdefinition sd\nwhere sv.ida3a6 = sd.ida2a2\n    and sv.ida3a4 = (\n        select distinct WP_IDA2A2 from V_LASTESTWTPART vl, wtpart wp, wtpartmaster wpm \n        where wpm.IDA2A2 = wp.IDA3MASTERREFERENCE\n            and wpm.IDA2A2 = vl.WPM_IDA2A2\n            and wpm.WTPARTNUMBER = '284260000006'\n    )\norder by sd.IDA2A2\n\n--\u53d6\u5f97\u6307\u5b9a\u6599\u865f\u6307\u5b9aIBA\u5c6c\u6027\u503c\nselect VALUE2 from stringvalue \nwhere ida3a4 = (\n    select distinct WP_IDA2A2 from V_LASTESTWTPART vl, wtpart wp, wtpartmaster wpm \n    where wpm.IDA2A2 = wp.IDA3MASTERREFERENCE\n        and wpm.IDA2A2 = vl.WPM_IDA2A2\n        and wpm.WTPARTNUMBER = '284260000006'\n) and ida3a6 = (\n    select IDA2A2 from stringdefinition where DESCRIPTION = 'SBU Applicant'\n)\n\n--\u4fee\u6539\u6307\u5b9amodel\u6307\u5b9aibaKey\u4e4bvalue\u503c\nupdate stringvalue \nset value2 = 'model desc change test', value = UPPER('model desc change test')\nwhere ida2a2 = (\n  select ida2a2 from stringvalue \n  where ida3a4 = (\n    select ida2a2 from mitacmodel\n    where modelcode = '8055'\n    and LATESTITERATIONINFO = '1'\n  ) and ida3a6 = (\n    select IDA2A2 from stringdefinition where DESCRIPTION = 'Model Description'\n  )\n)\n\n</code></pre>"},{"location":"windchill_wtObject/#2checkinout","title":"2.CheckInOut","text":"<p>\u4e0d\u9069\u7528\u65bc\u55ae\u64da\u985e</p> <pre><code>public static void checkInOutTest() throws Exception {\n      String partNum =\"227C52800015\";\n    WTPart part = GenericUtil.getLatestVersionPart(GenericUtil.getPartMaster(partNum));\n    Workable copy = (Workable) part;\n        GenericUtil.checkInOut(copy, false); //\u51fa\u5eab\n        //\u5c07\u526f\u672c\u8f49\u578b\u4e26\u4f5c\u8655\u7406\n        WTPart newPart = (WTPart) copy;\n        newPart.setName(\"newName\");\n        GenericUtil.checkInOut((Workable) newPart, true); //\u5165\u5eab\n}\n\npublic static void undoTest() throws Exception {\n    String partNum =\"227C52800015\";\n    WTPart part = GenericUtil.getLatestVersionPart(GenericUtil.getPartMaster(partNum));\n    Workable copy = (Workable) part;\n        GenericUtil.checkInOut(copy, false); //\u51fa\u5eab\n        //\u5c07\u526f\u672c\u8f49\u578b\u4e26\u4f5c\u8655\u7406\n        WTPart newPart = (WTPart) copy;\n        newPart.setName(\"newName\");\n    WorkInProgressHelper.service.undoCheckout((Workable) newPart); //\u6062\u5fa9\u51fa\u5eab\n}\n\n</code></pre>"},{"location":"windchill_wtPart/","title":"Windchill - WTPart","text":""},{"location":"windchill_wtPart/#wtpart","title":"WTPart","text":""},{"location":"windchill_wtPart/#1","title":"1. \u5c6c\u6027","text":""},{"location":"windchill_wtPart/#1-1","title":"1-1. \u6599\u865f\u8207\u54c1\u540d","text":"<p>\u53d6\u5f97\u6599\u865f\u8207\u54c1\u540d</p> <pre><code>String number = \"5651C5280009\";\nWTPartMaster master = GenericUtil.getPartMaster(number);\nWTPart wtpart = GenericUtil.getLatestVersionPart(master);\n\nString partNumber = wtpart.getNumber();\nString desc = wtpart.getName();\n\nSystem.out.println(\"\u6599\u865f\uff1a\" + partNumber);\nSystem.out.println(\"\u54c1\u540d\uff1a\"+desc);\n\n</code></pre>"},{"location":"windchill_wtPart/#1-2","title":"1-2. \u5efa\u7acb\u6642\u9593 \u4fee\u6539\u8005 \u5efa\u7acb\u8005 \u4fee\u6539\u8005","text":"<p>\u53d6\u5f97\u5efa\u7acb\u6642\u9593\u4fee\u6539\u8005\u548c\u5efa\u7acb\u8005\u53ca\u4fee\u6539\u8005</p> <pre><code>wtpart.getCreatorName();\nwtpart.getModifierName();\nwtpart.getCreateTimestamp();\nwtpart.getModifyTimestamp();\n\n</code></pre>"},{"location":"windchill_wtPart/#1-3","title":"1-3. \u72c0\u614b","text":"<p>\u8b8a\u66f4 / \u53d6\u5f97 \u96f6\u4ef6\u72c0\u614b</p> <pre><code>\nString status = \"MBOM_RELEASED\"; \nLifeCycleHelper.service.setLifeCycleState(wtpart, State.toState(status));\n\nString partStatus = wtpart.getLifeCycleState().toString(); //\u53d6\u5f97\u795e\u9054\u96f6\u4ef6\u72c0\u614b\nSystem.out.println(\"partStatus\uff1a\" + partStatus);\n\n</code></pre>"},{"location":"windchill_wtPart/#2","title":"2. \u7248\u672c","text":""},{"location":"windchill_wtPart/#2-1","title":"2-1. \u7248\u672c \u7248\u5e8f","text":"<p>\u53d6\u5f97\u7248\u672c \u7248\u5e8f</p> <pre><code>\nString verson = wtpart.getVersionInfo().getIdentifier().getValue(); //\u53d6\u5f97\u7248\u672c\nString iteration = wtpart.getIterationInfo().getIdentifier().getValue(); //\u53d6\u5f97\u7248\u5e8f\nSystem.out.println(\"version\uff1a\" + verson +\".\"+ iteration);\n\n</code></pre>"},{"location":"windchill_wtPart/#2-2-part","title":"2-2. \u4e0a\u4e00\u7248 PART","text":"<p>\u53d6\u5f97\u4e0a\u4e00\u7248PART, \u4e0b\u9762\u51fd\u6578\u7684input doc\u53ef\u76f4\u63a5\u4e1f wtpart</p> <pre><code>\npublic static RevisionControlled getPreviousVersion(RevisionControlled doc) {\n    RevisionControlled temp = null;\n    try {\n        String source = doc.getVersionIdentifier().getSeries().toString();\n        QueryResult qr = VersionControlHelper.service.allVersionsOf(doc);\n        while (qr.hasMoreElements()) {\n            RevisionControlled p = (RevisionControlled) qr.nextElement();\n            String target = p.getVersionIdentifier().getSeries().toString();\n            if ((target.length() == source.length()) &amp;&amp; target.compareTo(source) &lt; 0) {\n                temp = p;\n                break;\n            } else if (target.length() &lt; source.length()) {\n                temp = p;\n                break;\n            }\n        }\n    } catch (WTException e) {\n        e.printStackTrace();\n    }\n    return temp;\n}\n\n</code></pre>"},{"location":"windchill_wtPart/#2-3-part","title":"2-3. \u9000\u7248 PART","text":"<p>\u9000\u4e00\u500b\u5c0f\u7248\u5e8f</p> <pre><code>\npublic static String reversion(String partNum) {\n    String errMsg = \"\";\n    WTPart part = null;\n    try {\n        QueryResult qr = ConfigHelper.service.filteredIterationsOf(GenericUtil.getPartMaster(partNum), new LatestConfigSpec());\n        while(qr.hasMoreElements()){\n            part = (WTPart)qr.nextElement();\n            //String version =  VersionControlHelper.getVersionIdentifier((Versioned) part).getValue();\n            //String iteration = VersionControlHelper.getIterationIdentifier((Iterated) part).getValue();\n            //System.out.println(\"***********\"+version + \".\" + iteration);\n            ConflictResolution[] resolutions = { new ConflictResolution(VersionControlConflictType.LATEST_ITERATION_DELETE, VersionControlResolutionType.ALLOW_LATEST_ITERATION_DELETE)};\n            WTSet toDelete = new WTHashSet();\n            toDelete.add(part);\n            VersionControlHelper.service.deleteIterations(toDelete, resolutions);\n        }\n    } catch (Exception e) {\n        // TODO Auto-generated catch block\n        e.printStackTrace();\n        errMsg = \"reversion error and partNum:\"+partNum;\n    }\n\n    return errMsg;\n}\n\n\n</code></pre>"}]}